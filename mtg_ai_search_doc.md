# 产品设计文档：AI 辅助的万智牌卡牌搜索工具

## 一、产品概述
本产品旨在帮助万智牌玩家通过自然语言输入快速找到符合需求的卡牌。与传统基于关键词或复杂搜索语法的方式不同，本产品利用 AI 将玩家的自然语言需求转化为 **Scryfall 搜索语法**，并调用 Scryfall API 返回匹配的卡牌结果。

示例：
- 输入："帮我找一张地落卡组的强力终端"
- AI 转换：`o:"landfall" t:creature (o:"win" OR o:"end the game")`
- 输出：Scryfall 搜索结果列表

## 二、目标用户
- 万智牌玩家（休闲/竞技）
- 想快速构筑卡组的新手
- 内容创作者（写卡表、做教学）
- 店家/赛事组织者（辅助推荐卡牌）

## 三、核心功能

### 1. 自然语言解析 → Scryfall 搜索语法
- **输入**：中文/英文自然语言描述
- **输出**：Scryfall 兼容的查询语句
- **逻辑**：
  - 识别卡组主题（如“地落”“神器”“磨牌”）
  - 识别功能需求（如“过牌”“解场”“终端”）
  - 识别卡牌类型（如“生物”“鹏洛客”“瞬间”）
  - 映射到 Scryfall 搜索语法

### 2. 搜索结果展示
- 展示卡牌图片、名称、规则文本
- 支持跳转到 Scryfall 详情页
- 支持分页 / 滚动加载

### 3. 多轮对话优化
- 用户可以进一步 refine：
  - "再加上要是绿牌"
  - "费用在 4 点以下"
- AI 根据上下文补全新的 Scryfall 查询语句

### 4. 收藏与导出
- 用户可将搜索结果添加到 **收藏夹**
- 导出为：
  - 卡表 (TXT / CSV / MTG Arena 格式)
  - 直接导入 Cockatrice、Moxfield、Arena 等平台

## 四、差异化优势
- **相比 `nlp2scryfall`**：不仅仅是关键词映射，而是智能语义解析，支持模糊表达和组合条件。
- **相比 `Scryfall.AI`**：支持中文输入与多轮对话 refinement，更适合亚洲玩家群体。
- **相比人工搜索**：节省记忆复杂语法的成本。

## 五、技术架构

### 1. 前端
- Web 应用（React / Vue）
- 搜索输入框 + 对话式交互界面
- 卡牌结果展示（调用 Scryfall 图像 API）

### 2. 后端
- Node.js / Python Flask FastAPI
- API 网关：处理前端请求
- AI 模块：
  - LLM（GPT/本地模型）负责 NLU → 语法映射
  - Prompt engineering + 规则库（内置常见 archetype 和需求 → Scryfall 语法映射）

### 3. 数据来源
- Scryfall API （免费公开）
- 本地缓存热门卡牌/常用搜索加快响应

## 六、开发阶段规划

### 阶段 1：MVP
- 输入自然语言 → 输出 Scryfall 搜索语法
- 返回卡牌 JSON + 图片链接

### 阶段 2：增强体验
- 支持多轮对话 refinement
- 中文支持优化
- 收藏与导出功能

### 阶段 3：扩展功能
- 与卡组构筑平台对接（Moxfield、Arena）
- 推荐替代卡（基于语义相似度）
- 用户偏好学习（记住常用风格）

## 七、潜在问题与解决方案
- **问题：自然语言解析不精确** → 提供“编辑搜索语法”功能，用户可手动微调
- **问题：搜索过慢** → 本地缓存常用 archetype 的查询结果
- **问题：玩家表达多样化** → 增强 prompt 工程，建立专门的卡牌语义词典

## 八、未来发展方向
- 与 deckstats / tappedout 集成，实现一键导入导出
- 提供 AI 辅助构筑（自动推荐曲线/补充卡）
- 多语言支持（中文、日文、德文）

---

